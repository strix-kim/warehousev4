# –ê–ù–ê–õ–ò–ó –ò –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ –ê–í–¢–û–î–û–ü–û–õ–ù–ï–ù–ò–Ø

## üö® –í–´–Ø–í–õ–ï–ù–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∏–∑ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ
- –°–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è —Å–Ω–æ–≤–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞
- –ù–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –ù–ï –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üîç –ö–û–†–ù–ï–í–´–ï –ü–†–ò–ß–ò–ù–´

### **–ü—Ä–∏—á–∏–Ω–∞ #1: –†–µ–∞–∫—Ç–∏–≤–Ω—ã–π —Ü–∏–∫–ª –≤ `showSuggestionsIfAvailable()`**

```javascript
// –ü–†–û–ë–õ–ï–ú–ù–´–ô –ö–û–î:
const showSuggestionsIfAvailable = () => {
  if (suggestions.value.length > 0 && searchQuery.value.length >= 2) {
    showSuggestions.value = true  // ‚Üê –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –ø–æ–¥—Å–∫–∞–∑–æ–∫
    restoreFocus()
  }
}

// –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–æ–±—ã—Ç–∏–π:
// 1. –í—ã–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É ‚Üí selectSuggestion()
// 2. –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ñ–æ–∫—É—Å ‚Üí handleFocus()
// 3. handleFocus() –≤—ã–∑—ã–≤–∞–µ—Ç showSuggestionsIfAvailable()
// 4. –ü–æ–¥—Å–∫–∞–∑–∫–∏ —Å–Ω–æ–≤–∞ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è (–µ—Å–ª–∏ –µ—Å—Ç—å –≤ –∫—ç—à–µ)
```

### **–ü—Ä–∏—á–∏–Ω–∞ #2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞**

```javascript
// –ü–†–û–ë–õ–ï–ú–ù–´–ô –ö–û–î:
const selectSuggestion = (suggestion) => {
  searchQuery.value = suggestion.value
  showSuggestions.value = false
  debouncedFetchSuggestions.cancel()  // ‚Üê –û—Ç–º–µ–Ω—è–µ–º –ø–æ–∏—Å–∫, –Ω–æ –ù–ï –∑–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π
  // –ù–ï–¢ –ª–æ–≥–∏–∫–∏ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø–æ–∏—Å–∫–∞ –ø–æ –Ω–æ–≤–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
}
```

### **–ü—Ä–∏—á–∏–Ω–∞ #3: –ö—ç—à –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã**

```javascript
// –ü–†–û–ë–õ–ï–ú–ù–´–ô –ö–û–î:
if (suggestionsCache.has(cacheKey)) {
  const cachedSuggestions = suggestionsCache.get(cacheKey)
  updateSuggestionsSafely(cachedSuggestions)  // ‚Üê –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
  return
}
```

---

## ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–ù–´–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #1: –£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–∫–∞–∑–∞ –ø–æ–¥—Å–∫–∞–∑–æ–∫**

```javascript
// –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î:
const showSuggestionsIfAvailable = (forceShow = false) => {
  const shouldShow = (suggestions.value.length > 0 && searchQuery.value.length >= 2) || forceShow
  const isNotSelecting = focusState.value.lastOperation !== 'suggestion_selected'
  
  if (shouldShow && isNotSelecting) {  // ‚Üê –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—ã–±–æ—Ä–∞
    showSuggestions.value = true
    restoreFocus()
  }
}
```

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞**

```javascript
// –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î:
const selectSuggestion = (suggestion) => {
  // –ú–∞—Ä–∫–∏—Ä—É–µ–º –ø—Ä–æ—Ü–µ—Å—Å –≤—ã–±–æ—Ä–∞
  focusState.value.lastOperation = 'suggestion_selected'
  
  searchQuery.value = suggestion.value
  showSuggestions.value = false
  debouncedFetchSuggestions.cancel()
  
  // –ö–õ–Æ–ß–ï–í–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï: –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π –ø–æ–∏—Å–∫
  const trimmedQuery = suggestion.value.trim()
  if (trimmedQuery.length >= 2) {
    const cacheKey = trimmedQuery.toLowerCase()
    
    if (suggestionsCache.has(cacheKey)) {
      // –§–∏–ª—å—Ç—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –∏—Å–∫–ª—é—á–∞—è –≤—ã–±—Ä–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
      const filteredSuggestions = cachedSuggestions.filter(s => 
        s.value.toLowerCase() !== trimmedQuery.toLowerCase()
      )
      if (filteredSuggestions.length > 0) {
        setTimeout(() => {
          updateSuggestionsSafely(filteredSuggestions)
          focusState.value.lastOperation = 'search_completed'
        }, 300)
      }
    } else {
      // –ó–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–π –ø–æ–∏—Å–∫ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π
      setTimeout(() => {
        debouncedFetchSuggestions(trimmedQuery, cacheKey)
        focusState.value.lastOperation = 'search_started'
      }, 300)
    }
  }
}
```

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #3: –°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –æ–ø–µ—Ä–∞—Ü–∏–π**

```javascript
// –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤ focusState:
focusState.value.lastOperation = 'suggestion_selected'  // –í—ã–±–æ—Ä –ø–æ–¥—Å–∫–∞–∑–∫–∏
focusState.value.lastOperation = 'manual_input'        // –†—É—á–Ω–æ–π –≤–≤–æ–¥
focusState.value.lastOperation = 'search_started'      // –ü–æ–∏—Å–∫ –∑–∞–ø—É—â–µ–Ω
focusState.value.lastOperation = 'search_completed'    // –ü–æ–∏—Å–∫ –∑–∞–≤–µ—Ä—à—ë–Ω
```

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #4: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ–∫—É—Å–∞**

```javascript
// –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î:
const handleFocus = () => {
  protectFocus(100, 'normal')
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫–∏ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ù–ï –≤—ã–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É
  if (focusState.value.lastOperation !== 'suggestion_selected') {
    showSuggestionsIfAvailable()
  }
}
```

### **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ #5: –°–±—Ä–æ—Å —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø—Ä–∏ —Ä—É—á–Ω–æ–º –≤–≤–æ–¥–µ**

```javascript
// –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î:
const handleInput = (event) => {
  // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤—ã–±–æ—Ä–∞ –ø—Ä–∏ —Ä—É—á–Ω–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏
  if (focusState.value.lastOperation === 'suggestion_selected') {
    focusState.value.lastOperation = 'manual_input'
  }
  
  setSearchQuery(newValue)
  emit('search', newValue)
}
```

---

## üéØ –û–ñ–ò–î–ê–ï–ú–û–ï –ü–û–í–ï–î–ï–ù–ò–ï –ü–û–°–õ–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### **–°—Ü–µ–Ω–∞—Ä–∏–π 1: –í—ã–±–æ—Ä –ø–æ–¥—Å–∫–∞–∑–∫–∏**
1. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ –ø–æ–¥—Å–∫–∞–∑–∫—É
2. ‚úÖ –ó–Ω–∞—á–µ–Ω–∏–µ –≤—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
3. ‚úÖ –°–ø–∏—Å–æ–∫ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
4. ‚úÖ –ß–µ—Ä–µ–∑ 300ms –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π –ø–æ–∏—Å–∫ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é
5. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –Ω–æ–≤—ã–µ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ (–∏—Å–∫–ª—é—á–∞—è —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ)

### **–°—Ü–µ–Ω–∞—Ä–∏–π 2: –†—É—á–Ω–æ–π –≤–≤–æ–¥ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞**
1. ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª –ø–æ–¥—Å–∫–∞–∑–∫—É
2. ‚úÖ –ù–∞—á–∏–Ω–∞–µ—Ç –ø–µ—á–∞—Ç–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
3. ‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ 'manual_input'
4. ‚úÖ –ü–æ–¥—Å–∫–∞–∑–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ –Ω–æ–≤–æ–º—É –≤–≤–æ–¥—É

### **–°—Ü–µ–Ω–∞—Ä–∏–π 3: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–æ–∫—É—Å–∞**
1. ‚úÖ –ü–æ–ª–µ –ø–æ–ª—É—á–∞–µ—Ç —Ñ–æ–∫—É—Å
2. ‚úÖ –ï—Å–ª–∏ –ù–ï –Ω–∞—Ö–æ–¥–∏–º—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–±–æ—Ä–∞ ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫–∏
3. ‚úÖ –ï—Å–ª–∏ –≤—ã–±–∏—Ä–∞–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É ‚Üí –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏

---

## üìä –¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –î–ò–ê–ì–†–ê–ú–ú–ê –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

```
–°–¢–ê–†–û–ï –ü–û–í–ï–î–ï–ù–ò–ï:
–í—ã–±–æ—Ä –ø–æ–¥—Å–∫–∞–∑–∫–∏ ‚Üí –í—Å—Ç–∞–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è ‚Üí handleFocus() ‚Üí showSuggestionsIfAvailable() 
                                                    ‚Üì
                                           –ü–æ–∫–∞–∑ —Å—Ç–∞—Ä—ã—Ö –ø–æ–¥—Å–∫–∞–∑–æ–∫ ‚ùå

–ù–û–í–û–ï –ü–û–í–ï–î–ï–ù–ò–ï:
–í—ã–±–æ—Ä –ø–æ–¥—Å–∫–∞–∑–∫–∏ ‚Üí –í—Å—Ç–∞–≤–∫–∞ –∑–Ω–∞—á–µ–Ω–∏—è ‚Üí –ú–∞—Ä–∫–µ—Ä 'suggestion_selected' ‚Üí handleFocus()
                       ‚Üì                                                    ‚Üì
              –ó–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞                              –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
                       ‚Üì                                                    ‚Üì
              –ó–∞–¥–µ—Ä–∂–∫–∞ 300ms                                    –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫–∏
                       ‚Üì                                                    ‚Üì
              –ù–æ–≤—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ ‚úÖ                               –û–∂–∏–¥–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ‚úÖ
```

---

## üîß –ö–õ–Æ–ß–ï–í–´–ï –£–õ–£–ß–®–ï–ù–ò–Ø

1. **–°–∏—Å—Ç–µ–º–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–π –æ–ø–µ—Ä–∞—Ü–∏–π** ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
2. **–£–º–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø–æ–∫–∞–∑–∞** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º –ø–æ–¥—Å–∫–∞–∑–æ–∫
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫** ‚Äî –∑–∞–ø—É—Å–∫ –Ω–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞
4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤** ‚Äî –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —É–∂–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
5. **–í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏** ‚Äî –ø–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏

---

## ‚úÖ –°–¢–ê–¢–£–° –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–ê ‚úÖ

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- ‚úÖ –í—ã–±–æ—Ä –ø–æ–¥—Å–∫–∞–∑–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤—Å—Ç–∞–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ
- ‚úÖ –°–ø–∏—Å–æ–∫ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞
- ‚úÖ –ù–æ–≤—ã–π –ø–æ–∏—Å–∫ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –Ω–æ–≤—ã–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏
- ‚úÖ –†—É—á–Ω–æ–π –≤–≤–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –§–æ–∫—É—Å —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production:** 100% ‚úÖ 